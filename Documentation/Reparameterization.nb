(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103816,       2841]
NotebookOptionsPosition[     99399,       2773]
NotebookOutlinePosition[     99779,       2789]
CellTagsIndexPosition[     99736,       2786]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "The goal of this notebook is to derive an analytical expression for the \
path linearization of the system:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox[
     OverscriptBox["x", "."], "_"], "=", 
    RowBox[{"F", "(", 
     RowBox[{
      UnderscriptBox["x", "_"], ",", 
      UnderscriptBox["u", "_"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "18034c85-75d0-4e47-98d7-fc8c79feb006"],
 ".\nBy path linearization, we really mean the trajectory linearization of \
the system parameterized with respect to a path variable.\nFirst, we begin by \
re-parameterizing our system from time, to the path variable, \[Phi], via the \
chain rule, and re-arranging things.\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    UnderscriptBox[
     OverscriptBox["x", "."], "_"], "=", 
    RowBox[{"F", "(", 
     RowBox[{
      UnderscriptBox["x", "_"], ",", 
      UnderscriptBox["u", "_"]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "dt"], 
     UnderscriptBox["x", "_"]}], "=", 
    RowBox[{"F", "(", 
     RowBox[{
      UnderscriptBox["x", "_"], ",", 
      UnderscriptBox["u", "_"]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "ds"], 
     UnderscriptBox["x", "_"], 
     FractionBox["ds", "dt"]}], "=", 
    RowBox[{"F", "(", 
     RowBox[{
      UnderscriptBox["x", "_"], ",", 
      UnderscriptBox["u", "_"]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "ds"], 
     UnderscriptBox["x", "_"]}], "=", 
    RowBox[{
     RowBox[{"F", "(", 
      RowBox[{
       UnderscriptBox["x", "_"], ",", 
       UnderscriptBox["u", "_"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["ds", "dt"], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]}],ExpressionUUID->
  "cf76bdad-957a-4fc0-8e04-105f3f1a1a09"],
 "\nThen by using a first order Taylor expansion on the right hand side, we \
get:\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "ds"], 
     UnderscriptBox["x", "_"]}], "\[TildeEqual]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"F", "(", 
         RowBox[{
          UnderscriptBox["x", "_"], ",", 
          UnderscriptBox["u", "_"]}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["ds", "dt"], ")"}], 
         RowBox[{"-", "1"}]]}], ")"}], 
      RowBox[{
       SubscriptBox[
        UnderscriptBox["x", "_"], "0"], ",", 
       SubscriptBox[
        UnderscriptBox["u", "_"], "0"]}]], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Del]", 
          UnderscriptBox["x", "_"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"F", "(", 
            RowBox[{
             UnderscriptBox["x", "_"], ",", 
             UnderscriptBox["u", "_"]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["ds", "dt"], ")"}], 
            RowBox[{"-", "1"}]]}], ")"}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        UnderscriptBox["x", "_"], "-", 
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Del]", 
          UnderscriptBox["u", "_"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"F", "(", 
            RowBox[{
             UnderscriptBox["x", "_"], ",", 
             UnderscriptBox["u", "_"]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["ds", "dt"], ")"}], 
            RowBox[{"-", "1"}]]}], ")"}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        UnderscriptBox["u", "_"], "-", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "d\[Phi]"], 
     UnderscriptBox["x", "_"]}], "\[TildeEqual]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"F", "(", 
         RowBox[{
          UnderscriptBox["x", "_"], ",", 
          UnderscriptBox["u", "_"]}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["ds", "dt"], ")"}], 
         RowBox[{"-", "1"}]]}], ")"}], 
      RowBox[{
       SubscriptBox[
        UnderscriptBox["x", "_"], "0"], ",", 
       SubscriptBox[
        UnderscriptBox["u", "_"], "0"]}]], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["x", "_"]], 
           RowBox[{"(", 
            RowBox[{"F", "(", 
             RowBox[{
              UnderscriptBox["x", "_"], ",", 
              UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["ds", "dt"], ")"}], 
           RowBox[{"-", "1"}]]}], "+", 
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{
            UnderscriptBox["x", "_"], ",", 
            UnderscriptBox["u", "_"]}], ")"}], 
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["x", "_"]], 
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["ds", "dt"], ")"}], 
             RowBox[{"-", "1"}]], ")"}]}]}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        UnderscriptBox["x", "_"], "-", 
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\t\t\t\t", 
    RowBox[{
     RowBox[{"+", 
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["u", "_"]], 
           RowBox[{"(", 
            RowBox[{"F", "(", 
             RowBox[{
              UnderscriptBox["x", "_"], ",", 
              UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["ds", "dt"], ")"}], 
           RowBox[{"-", "1"}]]}], "+", 
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{
            UnderscriptBox["x", "_"], ",", 
            UnderscriptBox["u", "_"]}], ")"}], 
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["u", "_"]], 
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["ds", "dt"], ")"}], 
             RowBox[{"-", "1"}]], ")"}]}]}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]]}], 
     RowBox[{"(", 
      RowBox[{
       UnderscriptBox["u", "_"], "-", 
       SubscriptBox[
        UnderscriptBox["u", "_"], "0"]}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"ad864044-53dc-415c-bd70-c6d1b8d106f4"],
 "\nWhere all of the trajectories, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    UnderscriptBox["x", "_"], "0"], TraditionalForm]],ExpressionUUID->
  "7343be6b-b2fa-415d-a1ea-6ccaf6da2c18"],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    UnderscriptBox["u", "_"], "0"], TraditionalForm]],ExpressionUUID->
  "d404e353-386e-48fe-945a-3edc95e5eff2"],
 ",",
 Cell[BoxData[
  FormBox[
   UnderscriptBox["x", "_"], TraditionalForm]],ExpressionUUID->
  "9204eda4-7a2e-4ca5-9d29-c1bd1f7ccc0f"],
 ", and ",
 Cell[BoxData[
  FormBox[
   UnderscriptBox["u", "_"], TraditionalForm]],ExpressionUUID->
  "4ebd2029-b8c2-4fb6-8c9c-d2d632b9347c"],
 " are parameterized with respect to \[Phi], not ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],ExpressionUUID->
  "1865d1d6-2b97-45d4-a906-fad7dcbdaa74"],
 ".  Note, later on I realized that applying the chain rule to separate the \
gradients into two terms was unnecessary, as Mathematica could probably \
handle the gradient of the whole thing (I did verify that I would get the \
same answer either way).  However, I\[CloseCurlyQuote]m leaving it like this \
for the time being.  Additionally, applying this chain rule kind of helps \
show how the path linearization depends on F and also how it relates to what \
we would think of as a normal time-domain trajectory linearization.\n\tSo \
then in order to evaluate this, we need to find our normal \
gradients/Jacobians ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Del]", 
     UnderscriptBox["x", "_"]], 
    RowBox[{"(", 
     RowBox[{"F", "(", 
      RowBox[{
       UnderscriptBox["x", "_"], ",", 
       UnderscriptBox["u", "_"]}], ")"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"6ae52d2c-ed0c-4a3a-874e-a7acf2510a1b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Del]", 
     UnderscriptBox["u", "_"]], 
    RowBox[{"(", 
     RowBox[{"F", "(", 
      RowBox[{
       UnderscriptBox["x", "_"], ",", 
       UnderscriptBox["u", "_"]}], ")"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"01ef4e79-bda5-484f-a077-83304322f53b"],
 ", but we also need to find expressions for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["ds", "dt"], ")"}], 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "2fb46123-9099-41b5-a8db-f0fca32ce37c"],
 " and the gradients of this term, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Del]", 
     UnderscriptBox["x", "_"]], 
    RowBox[{"(", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["ds", "dt"], ")"}], 
      RowBox[{"-", "1"}]], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d1428bf5-1be2-4615-bb92-f9130d2dcab8"],
 ", and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Del]", 
     UnderscriptBox["u", "_"]], 
    RowBox[{"(", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["ds", "dt"], ")"}], 
      RowBox[{"-", "1"}]], ")"}]}], TraditionalForm]],ExpressionUUID->
  "336097ff-760e-468e-b806-9421ef8d141a"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.790442630172333*^9, 3.790442658591521*^9}, {
  3.7904427557992783`*^9, 
  3.790442808167839*^9}},ExpressionUUID->"dff7e40d-62de-44da-8d51-\
60e1b3b62ef3"],

Cell["Define the dynamic model", "Text",
 CellChangeTimes->{{3.790438580721983*^9, 
  3.7904385857784185`*^9}},ExpressionUUID->"df410f80-1622-43c0-b38f-\
c555dc6adc96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xUnderline", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"v", "[", "t", "]"}], ",", 
     RowBox[{"\[Psi]", "[", "t", "]"}], ",", 
     RowBox[{"\[Omega]", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uUnderline", "=", 
   RowBox[{"{", 
    RowBox[{"u", "[", "t", "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
       RowBox[{"r", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "r"], ",", 
      FractionBox[
       SubscriptBox["F", "x"], "M"], ",", 
      RowBox[{"\[Omega]", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"\[Omega]", "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]], 
        RowBox[{"u", "[", "t", "]"}]}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["F", "x"], "\[Rule]", 
      RowBox[{"c", "*", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "2"], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"\[Phi]", "[", "t", "]"}], "d"], ")"}], "2"]}], "]"}]}]}],
      "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
       RowBox[{"r", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "r"], ",", 
      FractionBox[
       SubscriptBox["F", "x"], "M"], ",", 
      RowBox[{"\[Omega]", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"\[Omega]", "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]], 
        RowBox[{"u", "[", "t", "]"}]}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["F", "x"], "\[Rule]", 
      RowBox[{"c", "*", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "2"], 
       RowBox[{"(", 
        RowBox[{"d", "-", 
         RowBox[{"v", "[", "t", "]"}]}], ")"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
       RowBox[{"r", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "r"], ",", 
      FractionBox[
       SubscriptBox["F", "x"], "M"], ",", 
      RowBox[{"\[Omega]", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"\[Omega]", "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]], 
        RowBox[{"u", "[", "t", "]"}]}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["F", "x"], "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
       RowBox[{"r", " "}]], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"v", "[", "t", "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "r"], ",", 
      FractionBox[
       SubscriptBox["F", "x"], "M"], ",", 
      RowBox[{"\[Omega]", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"\[Omega]", "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]], 
        RowBox[{"u", "[", "t", "]"}]}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["F", "x"], "\[Rule]", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790438574045353*^9, 3.790438628469136*^9}, {
   3.7904414396662717`*^9, 3.7904416387568398`*^9}, {3.7904419683507786`*^9, 
   3.7904419691190243`*^9}, {3.790442385361988*^9, 3.790442424179962*^9}, {
   3.7904424739069824`*^9, 3.79044249617793*^9}, {3.790444214392187*^9, 
   3.7904442206045227`*^9}, {3.790517021105655*^9, 3.7905170231326895`*^9}, {
   3.790517124623416*^9, 3.7905171272221675`*^9}, {3.79051877255612*^9, 
   3.7905188129598923`*^9}, 3.7905192862923975`*^9, {3.790522925671461*^9, 
   3.790522939951542*^9}, {3.7905234424368796`*^9, 3.7905234523751216`*^9}, {
   3.790523907061352*^9, 3.790523910424749*^9}, {3.79052395181704*^9, 
   3.790523972468156*^9}, {3.7905338321791945`*^9, 3.790533875943634*^9}, {
   3.790533918379897*^9, 3.7905339219067154`*^9}, {3.790534003395714*^9, 
   3.7905340244756927`*^9}, 3.7905355749392033`*^9, {3.7905363993345966`*^9, 
   3.7905364343709965`*^9}, {3.7905365598893437`*^9, 3.790536565590605*^9}, {
   3.7905366508532877`*^9, 3.790536651761846*^9}, {3.7905369885152545`*^9, 
   3.790536993927675*^9}, {3.7905370490687723`*^9, 3.790537053119853*^9}, {
   3.7905371001417627`*^9, 
   3.790537104012929*^9}},ExpressionUUID->"8cc11dc9-0ad9-464e-a95f-\
60c0d746671c"],

Cell["Define the path shape function", "Text",
 CellChangeTimes->{{3.7904417712813697`*^9, 3.790441780758175*^9}, 
   3.7904426680677433`*^9},ExpressionUUID->"3c615ee4-4932-4b1b-8983-\
13f8db9db585"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["W", "2"], 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "\[Pi]", " ", "s"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["H", "2"]}], 
      RowBox[{"Sin", "[", 
       RowBox[{"4", "\[Pi]", " ", "s"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["W", "2"], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "\[Pi]", " ", "s"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["W", "2"], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "\[Pi]", " ", "s"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7904417819817586`*^9, 3.7904418555202475`*^9}, 
   3.7904426873239594`*^9, {3.790515914375927*^9, 3.79051591820677*^9}, {
   3.790515959349527*^9, 3.790515964122608*^9}, {3.790537403665092*^9, 
   3.7905374142636013`*^9}, {3.7905374566514072`*^9, 
   3.790537469780837*^9}},ExpressionUUID->"dc0f1ac4-77fb-4f79-867d-\
d33de58f6ff0"],

Cell["\<\
Next, define the set of assumptions used to help Mathematica simplify things\
\>", "Text",
 CellChangeTimes->{{3.7904416434762144`*^9, 3.7904416564592495`*^9}, {
  3.79044267779338*^9, 
  3.7904426781542997`*^9}},ExpressionUUID->"42842cde-514c-4aac-a8be-\
2464373cb6bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myAssumptions", " ", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "t", "]"}], ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
        RowBox[{"v", "[", "t", "]"}], ",", 
        RowBox[{"\[Psi]", "[", "t", "]"}], ",", 
        RowBox[{"\[Omega]", "[", "t", "]"}], ",", 
        RowBox[{
         SubscriptBox["\[Psi]", "SP"], "[", "t", "]"}], ",", "M", ",", "a", 
        ",", "b", ",", "c", ",", "d", ",", "\[Tau]", ",", "W", ",", "H", ",", 
        "s", ",", "r"}], "}"}], "\[Element]", "Reals"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "a", ",", "b", ",", "c", ",", "d", ",", "\[Tau]", ",", "W", 
        ",", "H", ",", "s", ",", "r"}], "}"}], ">", "0"}], ",", 
     RowBox[{"s", "\[LessEqual]", " ", "1"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "<", 
      FractionBox["\[Pi]", "2"]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "t", "]"}], ">", 
      RowBox[{"-", 
       FractionBox["\[Pi]", "2"]}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "t", "]"}], "<", 
      FractionBox["\[Pi]", "2"]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7904416586247883`*^9, 3.790441751599633*^9}, {
   3.7904418669834213`*^9, 3.7904418905645447`*^9}, {3.7904425283320413`*^9, 
   3.79044253901227*^9}, 3.790442686284847*^9, {3.7905159251264553`*^9, 
   3.7905159274063835`*^9}, {3.790515973731045*^9, 3.7905159773364315`*^9}, {
   3.790516715991029*^9, 3.790516721213271*^9}, {3.790518822601274*^9, 
   3.79051884040919*^9}, {3.790518889034938*^9, 3.7905189242139287`*^9}, {
   3.7905347020119576`*^9, 
   3.7905347655250807`*^9}},ExpressionUUID->"23cf683e-1b39-41ca-a073-\
a4b284fb5876"],

Cell["\<\
Define the function under the arg min.  The minimum of this defines what we \
mean by \[OpenCurlyDoubleQuote]closest point on the path\
\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.7904419065667334`*^9, 3.7904419121771507`*^9}, {
  3.7904426964322586`*^9, 
  3.7904427126482563`*^9}},ExpressionUUID->"a321a3a5-c531-447c-99db-\
3891152ea4a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "t", "]"}], "-", 
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.790441926291815*^9, 
  3.7904419437841973`*^9}},ExpressionUUID->"65517908-fe07-4249-8a72-\
4697b3bc60bc"],

Cell[TextData[{
 "Differentiate to get ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["ds", "dt"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], 
      RowBox[{"s", "(", "t", ")"}]}], "=", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SubscriptBox["\[PartialD]", "s"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], 
         RowBox[{"g", "(", 
          RowBox[{"t", ",", 
           RowBox[{"s", "(", "t", ")"}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[PartialD]", "s"], "2"], 
        RowBox[{"g", "(", 
         RowBox[{"t", ",", 
          RowBox[{"s", "(", "t", ")"}]}], ")"}]}]]}]}]}], TraditionalForm]],
  ExpressionUUID->"4366c2f0-7bae-4f5e-9346-d6c95a7ecd71"]
}], "Text",
 CellChangeTimes->{{3.790442001006815*^9, 3.7904420264156322`*^9}, {
  3.79044272767378*^9, 
  3.790442741712083*^9}},ExpressionUUID->"3ed4c555-7f44-40a0-b737-\
5e5b8a3d1b22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dphidt", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"g", ",", "t"}], "]"}], ",", "s"}], "]"}]}], "/", 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "2"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790442053608333*^9, 
  3.7904420669463315`*^9}},ExpressionUUID->"36537c03-8c9b-493b-802d-\
24b7785847fd"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], 
  RowBox[{"2", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"W", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.790442035452648*^9, 3.790442067428838*^9, {3.790442253047914*^9, 
   3.790442273105215*^9}, 3.7904423129770665`*^9, 3.790442426396444*^9, 
   3.790442498164569*^9, 3.790442691572192*^9, 3.7904432586033916`*^9, 
   3.7904433038575153`*^9, 3.790443651545997*^9, 3.790443721521245*^9, 
   3.7904442224287243`*^9, 3.7904461714086246`*^9, 3.7904469522594194`*^9, 
   3.790447054147931*^9, 3.790510853339187*^9, 3.7905159549935417`*^9, 
   3.7905159956076717`*^9, 3.7905167238678217`*^9, 3.7905171299520936`*^9, 
   3.7905188661583877`*^9, 3.7905189259121275`*^9, 3.790519287815271*^9, 
   3.790519471923191*^9, 3.790521066734823*^9, 3.7905228910571737`*^9, {
   3.7905229287578087`*^9, 3.790522953866045*^9}, {3.79052345665232*^9, 
   3.7905234946696434`*^9}, 3.7905239124385004`*^9, {3.790524082615344*^9, 
   3.7905241056256886`*^9}, 3.790533882335569*^9, 3.7905339265414886`*^9, 
   3.7905340300140367`*^9, {3.790534592389454*^9, 3.790534615666259*^9}, 
   3.7905355814586635`*^9, 3.790535947848668*^9, 3.790536444562168*^9, 
   3.7905365673072634`*^9, 3.7905366647416773`*^9, 3.790536995519577*^9, 
   3.7905370557195053`*^9, 3.7905371332306643`*^9, 3.7905373800176926`*^9, 
   3.790537416033799*^9, 
   3.790537471262839*^9},ExpressionUUID->"119a7d67-bfe9-4fbe-bec4-\
753f7008339e"]
}, Open  ]],

Cell["\<\
Simplify using the equations for the rate of change of the state variables\
\>", "Text",
 CellChangeTimes->{{3.7904433361363993`*^9, 
  3.7904433532891183`*^9}},ExpressionUUID->"1650435a-fc62-4ab9-a9b3-\
ed1e01b3bd12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dphidt", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", 
        RowBox[{"RHS", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
        RowBox[{"RHS", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790442110306306*^9, 
  3.7904421502690697`*^9}},ExpressionUUID->"cd28f5be-5187-4f9e-8707-\
dabe41dd3f4a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
   RowBox[{"v", "[", "t", "]"}]}], 
  RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"W", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.7904421523700094`*^9, {3.790442253087885*^9, 3.7904422731323166`*^9}, 
   3.790442313008316*^9, 3.7904424264264297`*^9, 3.7904424981905546`*^9, 
   3.7904426917424154`*^9, 3.7904432587213354`*^9, 3.7904433038921523`*^9, 
   3.79044365157299*^9, 3.7904437215368743`*^9, 3.790444222454712*^9, 
   3.7904461714316134`*^9, 3.7904469522814093`*^9, 3.7904470541769156`*^9, 
   3.7905108533701725`*^9, 3.7905167240677233`*^9, 3.7905171300740337`*^9, 
   3.790518869244299*^9, 3.7905189260570574`*^9, 3.7905192879258957`*^9, 
   3.790519472004385*^9, 3.790521066813338*^9, 3.7905228912001047`*^9, {
   3.7905229287883196`*^9, 3.7905229538900356`*^9}, {3.7905234566833076`*^9, 
   3.7905234946946297`*^9}, 3.790523912465488*^9, {3.7905240826433315`*^9, 
   3.790524105653678*^9}, 3.7905338823575583`*^9, 3.790533926569024*^9, 
   3.790534030036028*^9, {3.79053459251789*^9, 3.7905346158861465`*^9}, 
   3.790535581603609*^9, 3.790535948039569*^9, 3.7905364445801563`*^9, 
   3.7905365673252544`*^9, 3.790536664760974*^9, 3.790536995538684*^9, 
   3.790537055799472*^9, 3.7905371332969213`*^9, 3.7905373801366615`*^9, 
   3.7905374161157384`*^9, 
   3.79053747133595*^9},ExpressionUUID->"887ef62f-8b30-4f27-b738-\
1b362bf5d108"]
}, Open  ]],

Cell[TextData[{
 "So now I\[CloseCurlyQuote]ll try to evaluate the terms in the expression \
for the linearization, \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "d\[Phi]"], 
     UnderscriptBox["x", "_"]}], "\[TildeEqual]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"F", "(", 
         RowBox[{
          UnderscriptBox["x", "_"], ",", 
          UnderscriptBox["u", "_"]}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["ds", "dt"], ")"}], 
         RowBox[{"-", "1"}]]}], ")"}], 
      RowBox[{
       SubscriptBox[
        UnderscriptBox["x", "_"], "0"], ",", 
       SubscriptBox[
        UnderscriptBox["u", "_"], "0"]}]], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["x", "_"]], 
           RowBox[{"(", 
            RowBox[{"F", "(", 
             RowBox[{
              UnderscriptBox["x", "_"], ",", 
              UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["ds", "dt"], ")"}], 
           RowBox[{"-", "1"}]]}], "+", 
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{
            UnderscriptBox["x", "_"], ",", 
            UnderscriptBox["u", "_"]}], ")"}], 
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["x", "_"]], 
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["ds", "dt"], ")"}], 
             RowBox[{"-", "1"}]], ")"}]}]}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        UnderscriptBox["x", "_"], "-", 
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["u", "_"]], 
           RowBox[{"(", 
            RowBox[{"F", "(", 
             RowBox[{
              UnderscriptBox["x", "_"], ",", 
              UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["ds", "dt"], ")"}], 
           RowBox[{"-", "1"}]]}], "+", 
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{
            UnderscriptBox["x", "_"], ",", 
            UnderscriptBox["u", "_"]}], ")"}], 
          RowBox[{
           SubscriptBox["\[Del]", 
            UnderscriptBox["u", "_"]], 
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["ds", "dt"], ")"}], 
             RowBox[{"-", "1"}]], ")"}]}]}]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"], "-", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"557b65d7-09eb-4b5a-a977-f15ba237b708"],
 "\nDefining some intermediate variables:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     UnderscriptBox["x", "_"], "0"], "'"}], TraditionalForm]],ExpressionUUID->
  "2e118192-1eb1-4758-94bb-6b87bf20d6e3"],
 ":=",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{
      UnderscriptBox["x", "_"], ",", 
      UnderscriptBox["u", "_"]}], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["ds", "dt"], ")"}], 
     RowBox[{"-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "7b6adc73-43d6-4d78-b8ed-6ee71f76ef28"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", ":=", 
    RowBox[{
     SubscriptBox["\[Del]", 
      UnderscriptBox["x", "_"]], 
     RowBox[{"(", 
      RowBox[{"F", "(", 
       RowBox[{
        UnderscriptBox["x", "_"], ",", 
        UnderscriptBox["u", "_"]}], ")"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"7d7d224f-f4d2-4811-b581-720ecc1b14b2"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "1"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Del]", 
        UnderscriptBox["x", "_"]], 
       RowBox[{"(", 
        RowBox[{"F", "(", 
         RowBox[{
          UnderscriptBox["x", "_"], ",", 
          UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["ds", "dt"], ")"}], 
       RowBox[{"-", "1"}]]}], "=", "A"}]}], TraditionalForm]],ExpressionUUID->
  "78372bef-6bab-45fe-9020-659c00c052aa"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["ds", "dt"], ")"}], 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "c83b6174-c107-4ee4-8e75-cf13e2a9bdc8"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "2"], ":=", 
    RowBox[{
     RowBox[{"F", "(", 
      RowBox[{
       UnderscriptBox["x", "_"], ",", 
       UnderscriptBox["u", "_"]}], ")"}], 
     RowBox[{
      SubscriptBox["\[Del]", 
       UnderscriptBox["x", "_"]], 
      RowBox[{"(", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["ds", "dt"], ")"}], 
        RowBox[{"-", "1"}]], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "e745251e-3fcc-4351-9d54-44f35e45904b"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", "1"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Del]", 
        UnderscriptBox["u", "_"]], 
       RowBox[{"(", 
        RowBox[{"F", "(", 
         RowBox[{
          UnderscriptBox["x", "_"], ",", 
          UnderscriptBox["u", "_"]}], ")"}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["ds", "dt"], ")"}], 
       RowBox[{"-", "1"}]]}], "=", 
     SuperscriptBox[
      RowBox[{"B", "(", 
       FractionBox["ds", "dt"], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "42bdd89d-03e1-4944-b73b-2c4280712f50"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", "2"], ":=", 
    RowBox[{
     RowBox[{"F", "(", 
      RowBox[{
       UnderscriptBox["x", "_"], ",", 
       UnderscriptBox["u", "_"]}], ")"}], 
     RowBox[{
      SubscriptBox["\[Del]", 
       UnderscriptBox["u", "_"]], 
      RowBox[{"(", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["ds", "dt"], ")"}], 
        RowBox[{"-", "1"}]], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ec4cd425-a326-4d93-8b47-3de84720d0f5"],
 "\nThen the linearization has the form\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "d\[Phi]"], 
     UnderscriptBox["x", "_"]}], "\[TildeEqual]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], "'"}], ")"}], 
      RowBox[{
       SubscriptBox[
        UnderscriptBox["x", "_"], "0"], ",", 
       SubscriptBox[
        UnderscriptBox["u", "_"], "0"]}]], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["A", "1"], "+", 
         SubscriptBox["A", "2"]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        UnderscriptBox["x", "_"], "-", 
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["B", "1"], "+", 
         SubscriptBox["B", "2"]}], ")"}], 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["x", "_"], "0"], ",", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}]], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"], "-", 
        SubscriptBox[
         UnderscriptBox["u", "_"], "0"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"734239a5-4373-4e52-bae0-007ec260ce8c"],
 "\nSo let\[CloseCurlyQuote]s calculate these intermediate variables"
}], "Text",
 CellChangeTimes->{{3.7584780681920595`*^9, 3.7584784536807976`*^9}, {
  3.7584810469657516`*^9, 3.7584810544297895`*^9}, {3.7904428457418957`*^9, 
  3.7904428737510004`*^9}, {3.7904430082275295`*^9, 
  3.7904430160768557`*^9}},ExpressionUUID->"754ee927-c0af-4a9d-9278-\
ba8a4db0f989"],

Cell["\<\
Note, these first things are the what you would get with a traditional, \
time-domain linearization, if you\[CloseCurlyQuote]re curious\
\>", "Text",
 CellChangeTimes->{{3.790524023296812*^9, 
  3.790524069749751*^9}},ExpressionUUID->"ef379402-8346-4a69-bbe1-\
f033a13a34e4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x0Prime", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"RHS", "*", 
        SuperscriptBox[
         RowBox[{"(", "dphidt", ")"}], 
         RowBox[{"-", "1"}]]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], 
   "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"A", " ", "=", 
    RowBox[{"Grad", "[", 
     RowBox[{"RHS", ",", "xUnderline"}], "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"B", " ", "=", 
    RowBox[{"Grad", "[", 
     RowBox[{"RHS", ",", "uUnderline"}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.758478458706351*^9, 3.758478748012472*^9}, {
   3.75847878219339*^9, 3.7584788171884336`*^9}, 3.758478856394558*^9, {
   3.758480581745784*^9, 3.758480582695592*^9}, {3.7584807158553944`*^9, 
   3.758480729367902*^9}, 3.7584809008147006`*^9, {3.7584813669737487`*^9, 
   3.758481374437784*^9}, {3.758482070766136*^9, 3.7584820716457863`*^9}, {
   3.790442213809904*^9, 3.7904422341891813`*^9}, {3.7904422707626085`*^9, 
   3.790442278941366*^9}, 3.790442310714114*^9, {3.7904430288844905`*^9, 
   3.7904430799448633`*^9}, {3.7904431158223*^9, 3.790443256381776*^9}, 
   3.790443390150675*^9, {3.7904436850786767`*^9, 3.7904437012545786`*^9}, {
   3.790444175925575*^9, 
   3.790444185571718*^9}},ExpressionUUID->"4194497e-0e2f-4a67-92be-\
bbd643dce955"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      FractionBox[
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "r"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}], "r"]}], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "r"], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"v", "[", "t", "]"}]}], "r"], "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1"},
     {"0", "0", "0", 
      RowBox[{"-", "a"}], 
      RowBox[{"-", "b"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790444222575398*^9, 3.7904461714565997`*^9, 3.7904469523113947`*^9, 
   3.7904470542129*^9, 3.7905108534980373`*^9, 3.790516724821372*^9, 
   3.7905171307977333`*^9, 3.790518926819744*^9, 3.7905192885316095`*^9, 
   3.790519472459628*^9, 3.790521067299779*^9, 3.790522891861788*^9, {
   3.790522929072181*^9, 3.7905229539140244`*^9}, {3.790523456711294*^9, 
   3.7905234947216167`*^9}, 3.7905239124994726`*^9, {3.7905240737828155`*^9, 
   3.7905241056876616`*^9}, 3.790533882526478*^9, 3.7905339267750387`*^9, 
   3.7905340307636795`*^9, {3.790534593752302*^9, 3.7905346170365953`*^9}, 
   3.7905355885327415`*^9, 3.7905359486593695`*^9, 3.7905364447610765`*^9, 
   3.790536567521163*^9, 3.7905366649054823`*^9, 3.790536995558674*^9, 
   3.790537056005376*^9, 3.790537133366889*^9, 3.790537380475499*^9, 
   3.7905374164578276`*^9, 
   3.7905374716368055`*^9},ExpressionUUID->"77fcb345-8fb5-4f7b-8de2-\
501f941e5cf2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {
      FractionBox["1", 
       SuperscriptBox["\[Tau]", "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790444222575398*^9, 3.7904461714565997`*^9, 3.7904469523113947`*^9, 
   3.7904470542129*^9, 3.7905108534980373`*^9, 3.790516724821372*^9, 
   3.7905171307977333`*^9, 3.790518926819744*^9, 3.7905192885316095`*^9, 
   3.790519472459628*^9, 3.790521067299779*^9, 3.790522891861788*^9, {
   3.790522929072181*^9, 3.7905229539140244`*^9}, {3.790523456711294*^9, 
   3.7905234947216167`*^9}, 3.7905239124994726`*^9, {3.7905240737828155`*^9, 
   3.7905241056876616`*^9}, 3.790533882526478*^9, 3.7905339267750387`*^9, 
   3.7905340307636795`*^9, {3.790534593752302*^9, 3.7905346170365953`*^9}, 
   3.7905355885327415`*^9, 3.7905359486593695`*^9, 3.7905364447610765`*^9, 
   3.790536567521163*^9, 3.7905366649054823`*^9, 3.790536995558674*^9, 
   3.790537056005376*^9, 3.790537133366889*^9, 3.790537380475499*^9, 
   3.7905374164578276`*^9, 
   3.790537471641802*^9},ExpressionUUID->"32d50125-082c-4f0c-ac84-\
642fbeb456e9"]
}, Open  ]],

Cell["Calculate A1 and A2 terms", "Text",
 CellChangeTimes->{{3.790443706236471*^9, 3.790443710464185*^9}, {
  3.7905233987357483`*^9, 
  3.7905234005039377`*^9}},ExpressionUUID->"cf6808e1-5248-4e9d-ae24-\
77630c0ace69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A1", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"A", "*", 
        SuperscriptBox[
         RowBox[{"(", "dphidt", ")"}], 
         RowBox[{"-", "1"}]]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], 
   "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A2", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "RHS", "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"Grad", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", "dphidt", ")"}], 
            RowBox[{"-", "1"}]], ",", "xUnderline"}], "]"}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], 
   "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7905233878757415`*^9, 
  3.7905233886103973`*^9}},ExpressionUUID->"ce8f1f53-27a4-475e-aaa0-\
3124e981b6d0"],

Cell["Calculate B1 and B2 terms", "Text",
 CellChangeTimes->{{3.790443716506686*^9, 3.790443719153775*^9}, {
  3.790523402767846*^9, 
  3.790523404959836*^9}},ExpressionUUID->"01d9769a-ddac-4afa-a6a6-\
357d9cc7cdd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"B1", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"B", "*", 
        SuperscriptBox[
         RowBox[{"(", "dphidt", ")"}], 
         RowBox[{"-", "1"}]]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], 
   "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"B2", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "RHS", "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"Grad", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", "dphidt", ")"}], 
            RowBox[{"-", "1"}]], ",", "uUnderline"}], "]"}], "}"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], 
   "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7905233831462235`*^9, 
  3.7905233840098825`*^9}},ExpressionUUID->"c7fd865d-4a7d-4748-9093-\
958dda14b85e"],

Cell[TextData[{
 "Now if we define\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "s"], "=", 
    RowBox[{
     SubscriptBox["A", "1"], "+", 
     SubscriptBox["A", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "fdf59816-d1b3-4aee-9a32-8a2fa9acbed9"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", "s"], "=", 
    RowBox[{
     SubscriptBox["B", "1"], "+", 
     SubscriptBox["B", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "cde27144-78f4-41bd-8655-4cc9c98a125b"],
 "\t"
}], "Text",
 CellChangeTimes->{{3.7584788594224586`*^9, 3.7584789523678355`*^9}, {
   3.758479133176183*^9, 3.7584792014473267`*^9}, {3.7904429563592434`*^9, 
   3.7904429651857944`*^9}, {3.7904432670470943`*^9, 3.7904432848014965`*^9}, 
   3.79052408764226*^9},ExpressionUUID->"67381f35-b207-4d4d-b9b3-\
20946cf1afe4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"As", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"A1", "+", "A2"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Bs", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"B1", "+", "B2"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", "myAssumptions"}]}], "]"}]}], ")"}], "//",
   "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7584789593661118`*^9, 3.7584790097054586`*^9}, {
   3.7584805106280217`*^9, 3.758480526066721*^9}, 3.758481234949904*^9, 
   3.758481358575215*^9, 3.7584838653148127`*^9, {3.7904432935018835`*^9, 
   3.7904433014543624`*^9}, {3.7904436296782484`*^9, 3.790443650162335*^9}, {
   3.7904458605571046`*^9, 3.790445880768653*^9}, {3.7904459912533007`*^9, 
   3.790445992615489*^9}, {3.790446045433159*^9, 
   3.790446067095929*^9}},ExpressionUUID->"dcb29a07-a41f-43f9-a60c-\
ce1f69a6cebb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "W"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"Csc", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cot", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cot", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]]}], "0", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"W", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"]], "0"},
     {"0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "t", "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"\[Omega]", "[", "t", "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"W", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{"\[Omega]", "[", "t", "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"v", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"W", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{"\[Omega]", "[", "t", "]"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}], 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"W", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
        RowBox[{"v", "[", "t", "]"}]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"u", "[", "t", "]"}], 
            SuperscriptBox["\[Tau]", "2"]], "-", 
           RowBox[{"a", " ", 
            RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Cot", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"u", "[", "t", "]"}], 
            SuperscriptBox["\[Tau]", "2"]], "-", 
           RowBox[{"a", " ", 
            RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"W", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"u", "[", "t", "]"}], 
            SuperscriptBox["\[Tau]", "2"]], "-", 
           RowBox[{"a", " ", 
            RowBox[{"\[Psi]", "[", "t", "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"v", "[", "t", "]"}], "2"]}]]}], 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"W", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"u", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Tau]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "a"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}]}], "+", 
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
              RowBox[{"\[Psi]", "[", "t", "]"}]}], "+", 
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
              RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["\[Tau]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"], " ", 
        RowBox[{"v", "[", "t", "]"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "b", " ", "\[Pi]", " ", "r", " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"W", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", "t", "]"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7904458813713694`*^9, 3.790445993653983*^9, {3.790446046976965*^9, 
   3.790446062476477*^9}, 3.7904461717025976`*^9, 3.790446952550295*^9, 
   3.790447054460012*^9, 3.7905108538618855`*^9, 3.7905167640203643`*^9, 
   3.790517154894317*^9, 3.790518951022292*^9, 3.790519301225574*^9, 
   3.790519481085476*^9, 3.7905210763265867`*^9, {3.790522911384306*^9, 
   3.790522954145913*^9}, {3.7905234568800116`*^9, 3.790523494918747*^9}, 
   3.7905239129976215`*^9, {3.7905240828032565`*^9, 3.790524105820881*^9}, 
   3.7905338862605486`*^9, 3.790533954701482*^9, 3.7905340503587503`*^9, 
   3.790534648202714*^9, 3.7905356075376377`*^9, 3.790535971432277*^9, 
   3.7905364502755194`*^9, 3.7905365720484767`*^9, 3.790536668094352*^9, 
   3.7905369956805553`*^9, 3.7905370593392467`*^9, 3.7905371336616273`*^9, 
   3.790537383703555*^9, 3.790537418838936*^9, 
   3.7905374730427127`*^9},ExpressionUUID->"1495bfd4-5dbe-4ee8-90a4-\
cdceda4a5768"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "r", " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"W", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["\[Tau]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
        RowBox[{"v", "[", "t", "]"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7904458813713694`*^9, 3.790445993653983*^9, {3.790446046976965*^9, 
   3.790446062476477*^9}, 3.7904461717025976`*^9, 3.790446952550295*^9, 
   3.790447054460012*^9, 3.7905108538618855`*^9, 3.7905167640203643`*^9, 
   3.790517154894317*^9, 3.790518951022292*^9, 3.790519301225574*^9, 
   3.790519481085476*^9, 3.7905210763265867`*^9, {3.790522911384306*^9, 
   3.790522954145913*^9}, {3.7905234568800116`*^9, 3.790523494918747*^9}, 
   3.7905239129976215`*^9, {3.7905240828032565`*^9, 3.790524105820881*^9}, 
   3.7905338862605486`*^9, 3.790533954701482*^9, 3.7905340503587503`*^9, 
   3.790534648202714*^9, 3.7905356075376377`*^9, 3.790535971432277*^9, 
   3.7905364502755194`*^9, 3.7905365720484767`*^9, 3.790536668094352*^9, 
   3.7905369956805553`*^9, 3.7905370593392467`*^9, 3.7905371336616273`*^9, 
   3.790537383703555*^9, 3.790537418838936*^9, 
   3.7905374731236763`*^9},ExpressionUUID->"3a5b56c3-7297-4afd-8ba5-\
acfd692b578a"]
}, Open  ]],

Cell["\<\
Now, output in a Matlab friendly version to .txt files so that we can import \
and evaluate them straight in Matlab.\
\>", "Text",
 CellChangeTimes->{{3.7905190622143273`*^9, 3.79051906873328*^9}, {
  3.790524095048498*^9, 3.790524095385337*^9}, {3.790524217116886*^9, 
  3.7905242301161675`*^9}},ExpressionUUID->"d66e0729-b0a9-4cf1-b5ca-\
defdb7fcd6ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ToMatlab.m"}]}], "Input",
 CellChangeTimes->{{3.7905183410057373`*^9, 3.7905183658458056`*^9}, {
  3.79052329770539*^9, 
  3.7905232990067663`*^9}},ExpressionUUID->"0f7cdeaf-7a34-4d6a-9e41-\
17d1b897f848"],

Cell["\<\
Suppress time dependence and rename variables from Greek symbols to things \
Matlab can use\
\>", "Text",
 CellChangeTimes->{{3.790523311816638*^9, 
  3.790523346060706*^9}},ExpressionUUID->"5d2dbba9-c750-400b-a5c5-\
5b876b8b6759"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"supressionRules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", "\[Phi]"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]"}], ",", 
     RowBox[{
      RowBox[{"v", "[", "t", "]"}], "\[Rule]", "v"}], ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", "t", "]"}], "\[Rule]", "\[Psi]"}], ",", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "t", "]"}], "\[Rule]", "\[Omega]"}], ",", 
     RowBox[{
      RowBox[{"u", "[", "t", "]"}], "\[Rule]", "u"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"renamingRules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "theta"}], ",", 
     RowBox[{"\[Psi]", "\[Rule]", "psi"}], ",", 
     RowBox[{"\[Omega]", "\[Rule]", "omega"}], ",", 
     RowBox[{"\[Tau]", "\[Rule]", "tau"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7905186386008315`*^9, 3.790518677295496*^9}, {
  3.7905190744065633`*^9, 3.790519083031952*^9}, {3.7905193364978905`*^9, 
  3.7905193554561834`*^9}, {3.7905194101094637`*^9, 3.7905194405213537`*^9}, {
  3.790519958797363*^9, 3.7905199667076745`*^9}, {3.790523283454215*^9, 
  3.7905232962111053`*^9}},ExpressionUUID->"be1bde59-879b-40a5-9e61-\
835bded12d74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A11.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A21.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A31.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A41.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MatrixElementExpressions\\\\A51.txt\>\"", ",", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"As", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
       "renamingRules"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A12.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A22.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A32.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A42.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MatrixElementExpressions\\\\A52.txt\>\"", ",", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"As", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
       "renamingRules"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A13.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A23.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A33.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A43.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MatrixElementExpressions\\\\A53.txt\>\"", ",", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"As", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
       "renamingRules"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A14.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A24.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A34.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A44.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MatrixElementExpressions\\\\A54.txt\>\"", ",", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"As", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
       "renamingRules"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A15.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A25.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A35.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\A45.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"As", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<MatrixElementExpressions\\\\A55.txt\>\"", ",", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"As", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
       "renamingRules"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\B1.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\B2.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\B3.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bs", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\B4.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bs", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<MatrixElementExpressions\\\\B5.txt\>\"", ",", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Bs", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", "supressionRules"}], "/.", 
      "renamingRules"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7905184070607743`*^9, 3.790518432265563*^9}, 
   3.7905184683090086`*^9, {3.790518681785345*^9, 3.790518683798357*^9}, {
   3.7905194490967884`*^9, 3.7905194519989386`*^9}, {3.7905200947310724`*^9, 
   3.7905201038582754`*^9}, {3.790520181678997*^9, 3.7905203730291405`*^9}, {
   3.7905205407133255`*^9, 3.7905205612902226`*^9}, {3.790520957837989*^9, 
   3.790520998102135*^9}},ExpressionUUID->"d83a240f-d61f-48df-904f-\
90bfe510c90c"],

Cell["\<\
Code to evaluate expressions numerically, in order to compare with results \
obtained from Matlab.  Just to make sure it all went through properly.\
\>", "Text",
 CellChangeTimes->{{3.790521363661604*^9, 
  3.7905213894909325`*^9}},ExpressionUUID->"a7a4ef5c-6e74-4307-9097-\
44641ae239c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tstPt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "\[Rule]", "0.423504865"}], ",", 
     RowBox[{"theta", "\[Rule]", "0.441047356"}], ",", 
     RowBox[{"v", "\[Rule]", "5.314314159"}], ",", 
     RowBox[{"psi", "\[Rule]", "0.192778265"}], ",", 
     RowBox[{"omega", "\[Rule]", "0.264638308"}], ",", 
     RowBox[{"s", "\[Rule]", "0.150000000"}], ",", 
     RowBox[{"u", "\[Rule]", "0.206102619"}], ",", 
     RowBox[{"W", "\[Rule]", "60.000000000"}], ",", 
     RowBox[{"H", "\[Rule]", "10.000000000"}], ",", 
     RowBox[{"r", "\[Rule]", "100.000000000"}], ",", 
     RowBox[{"a", "\[Rule]", "1600.000000000"}], ",", 
     RowBox[{"b", "\[Rule]", "80.000000000"}], ",", 
     RowBox[{"c", "\[Rule]", "1000.000000000"}], ",", 
     RowBox[{"d", "\[Rule]", "1.047197551"}], ",", 
     RowBox[{"tau", "\[Rule]", "0.025000000"}], ",", 
     RowBox[{"M", "\[Rule]", "6923.600000000"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"As", "/.", "supressionRules"}], "/.", "renamingRules"}], "/.", 
   "tstPt"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bs", "/.", "supressionRules"}], "/.", "renamingRules"}], "/.", 
   "tstPt"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7905213922825923`*^9, 3.790521429360001*^9}, {
  3.790521543615657*^9, 3.7905215545966206`*^9}, {3.7905222199598303`*^9, 
  3.7905222223838005`*^9}, {3.7905222554635243`*^9, 3.7905222567339087`*^9}, {
  3.790522440872751*^9, 3.790522442394025*^9}, {3.7905227085809574`*^9, 
  3.790522709755402*^9}, {3.7905228040347633`*^9, 3.790522805478076*^9}, {
  3.790523006641229*^9, 3.790523009569825*^9}, {3.7905232074200907`*^9, 
  3.7905232105805697`*^9}},ExpressionUUID->"959f47f8-577c-48e5-9677-\
35cd0016ee12"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "3.819437862729395`"}], 
      RowBox[{"-", "3.819437862729395`"}], "0", "107.51193782178282`", "0"},
     {
      RowBox[{"-", "0.7455634742750028`"}], 
      RowBox[{"-", "0.7455634742750028`"}], "0", 
      RowBox[{"-", "107.51193782178284`"}], "0"},
     {"0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "19.378732326157845`"}], 
      RowBox[{"-", "19.378732326157845`"}], "118.17782259758611`", 
      "422.89097384659703`", 
      RowBox[{"-", "2373.1790029058907`"}]},
     {
      RowBox[{"-", "10.830437359076207`"}], 
      RowBox[{"-", "10.830437359076207`"}], "66.04753517068379`", 
      "3.797322751079362`*^6", "189854.32023247128`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790521429941715*^9, 3.7905215590530415`*^9, {3.7905222231924067`*^9, 
   3.790522257100731*^9}, 3.7905224435865965`*^9, {3.7905227029547825`*^9, 
   3.7905227153647594`*^9}, 3.790522805859887*^9, {3.7905229117869263`*^9, 
   3.7905229544597635`*^9}, 3.790523010096566*^9, 3.7905232120468664`*^9, {
   3.790523457291867*^9, 3.790523495257578*^9}, 3.7905239134444056`*^9, {
   3.7905240831315823`*^9, 3.790524106151726*^9}, 3.790533886787345*^9, 
   3.7905339552523184`*^9, 3.7905340507668123`*^9, 3.7905346488352976`*^9, 
   3.7905356080443974`*^9, 3.790535972064981*^9, 3.790536450707312*^9, 
   3.790536572372321*^9, 3.790536668498664*^9, 3.7905369960369034`*^9, 
   3.790537059776038*^9, 3.7905371340434437`*^9, 3.790537384027108*^9, 
   3.790537419355341*^9, 
   3.790537473469508*^9},ExpressionUUID->"ea1a07af-4c8b-4a92-ab25-\
9a386f3b2dbc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {
      RowBox[{"-", "3.797086404649425`*^6"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.790521429941715*^9, 3.7905215590530415`*^9, {3.7905222231924067`*^9, 
   3.790522257100731*^9}, 3.7905224435865965`*^9, {3.7905227029547825`*^9, 
   3.7905227153647594`*^9}, 3.790522805859887*^9, {3.7905229117869263`*^9, 
   3.7905229544597635`*^9}, 3.790523010096566*^9, 3.7905232120468664`*^9, {
   3.790523457291867*^9, 3.790523495257578*^9}, 3.7905239134444056`*^9, {
   3.7905240831315823`*^9, 3.790524106151726*^9}, 3.790533886787345*^9, 
   3.7905339552523184`*^9, 3.7905340507668123`*^9, 3.7905346488352976`*^9, 
   3.7905356080443974`*^9, 3.790535972064981*^9, 3.790536450707312*^9, 
   3.790536572372321*^9, 3.790536668498664*^9, 3.7905369960369034`*^9, 
   3.790537059776038*^9, 3.7905371340434437`*^9, 3.790537384027108*^9, 
   3.790537419355341*^9, 
   3.790537473475506*^9},ExpressionUUID->"51152d07-129b-4b9c-8c4d-\
dec10bd9d2b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Eigenvalues", "[", "As", "]"}], ",", "myAssumptions"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7905344057431264`*^9, 3.7905344243538513`*^9}, {
   3.7905345868461046`*^9, 3.790534612315053*^9}, {3.790535250739052*^9, 
   3.7905352520184374`*^9}, 3.7905359443093586`*^9, 3.790537274743842*^9, 
   3.790537372308276*^9, {3.790537483751709*^9, 
   3.7905374856168165`*^9}},ExpressionUUID->"813e8a6f-792b-4df3-a373-\
5063a5a43bb4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
    RowBox[{"Cot", "[", 
     RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["\[Tau]", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"v", "[", "t", "]"}], "2"]}]], 
    RowBox[{"\[Pi]", " ", 
     RowBox[{"Csc", "[", 
      RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        SuperscriptBox["\[Tau]", "2"], " ", 
        RowBox[{"v", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"W", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "-", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Abs", "[", "r", "]"}], " ", 
        RowBox[{"Abs", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], "]"}], " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"v", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "W"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], " ", 
        RowBox[{"Csc", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
           RowBox[{"u", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Tau]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", "a"}], "-", 
                 SuperscriptBox["b", "2"]}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", "a", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
              RowBox[{"\[Psi]", "[", "t", "]"}]}], "+", 
             RowBox[{"2", " ", "b", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
              RowBox[{"\[Omega]", "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"\[Omega]", "[", "t", "]"}], "2"]}]}], ")"}]}]}]]}]}], 
      ")"}]}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["\[Tau]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"v", "[", "t", "]"}], "2"]}]], 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"Csc", "[", 
       RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", " ", 
         SuperscriptBox["\[Tau]", "2"], " ", 
         RowBox[{"v", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"W", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "+", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "-", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
            RowBox[{"\[Omega]", "[", "t", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Abs", "[", "r", "]"}], " ", 
         RowBox[{"Abs", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], "]"}], " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"v", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "W"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "\[Pi]", " ", "s"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], " ", 
         RowBox[{"Csc", "[", 
          RowBox[{"2", " ", "\[Pi]", " ", "s"}], "]"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"u", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[Tau]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "a"}], "-", 
                  SuperscriptBox["b", "2"]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
              RowBox[{"4", " ", "a", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
               RowBox[{"\[Psi]", "[", "t", "]"}]}], "+", 
              RowBox[{"2", " ", "b", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}], " ", 
               RowBox[{"\[Omega]", "[", "t", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"\[Psi]", "[", "t", "]"}]}], "]"}]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"\[Omega]", "[", "t", "]"}], "2"]}]}], ")"}]}]}]]}]}],
        ")"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.790534414956708*^9, 3.790534654236842*^9, 3.790534773786255*^9, 
   3.790535972898574*^9, 3.7905364512720423`*^9, 3.7905365724406815`*^9, 
   3.7905366685630856`*^9, 3.7905369961393147`*^9, 3.790537059803032*^9, 
   3.7905371340766525`*^9, {3.7905373745092196`*^9, 3.790537384114744*^9}, 
   3.7905374193793297`*^9, {3.7905374734954967`*^9, 
   3.790537496441515*^9}},ExpressionUUID->"7abb5f5a-bb27-43bf-8657-\
4cb9c52cdf52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", "supressionRules"}]], "Input",
 CellChangeTimes->{{3.790536253404027*^9, 
  3.790536259357078*^9}},ExpressionUUID->"df63a4cb-9c76-4ec8-9e6f-\
25ba8dc3d72b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"b", " ", "r"}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "a"}], "+", 
         SuperscriptBox["b", "2"]}]], " ", 
       RowBox[{"Abs", "[", "r", "]"}]}]}], 
     RowBox[{"2", " ", "r"}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", "r"}], "+", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "a"}], "+", 
        SuperscriptBox["b", "2"]}]], " ", 
      RowBox[{"Abs", "[", "r", "]"}]}]}], 
    RowBox[{"2", " ", "r"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.790536260009798*^9, 3.7905364513080244`*^9, 
  3.7905365724646697`*^9, 3.7905366685850754`*^9, 3.7905369961633034`*^9, 
  3.7905370598280196`*^9, 3.7905371341166334`*^9, 3.7905373841417313`*^9, 
  3.790537419404318*^9, 
  3.7905374735194845`*^9},ExpressionUUID->"a75847f4-b5fe-4314-a627-\
e29221959bf6"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{Automatic, 1912}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10767, 343, 763, "Text",ExpressionUUID->"dff7e40d-62de-44da-8d51-60e1b3b62ef3"],
Cell[11328, 365, 168, 3, 52, "Text",ExpressionUUID->"df410f80-1622-43c0-b38f-c555dc6adc96"],
Cell[11499, 370, 6565, 186, 365, "Input",ExpressionUUID->"8cc11dc9-0ad9-464e-a95f-60c0d746671c"],
Cell[18067, 558, 199, 3, 52, "Text",ExpressionUUID->"3c615ee4-4932-4b1b-8983-13f8db9db585"],
Cell[18269, 563, 1083, 32, 145, "Input",ExpressionUUID->"dc0f1ac4-77fb-4f79-867d-d33de58f6ff0"],
Cell[19355, 597, 280, 6, 52, "Text",ExpressionUUID->"42842cde-514c-4aac-a8be-2464373cb6bd"],
Cell[19638, 605, 1876, 43, 105, "Input",ExpressionUUID->"23cf683e-1b39-41ca-a073-a4b284fb5876"],
Cell[21517, 650, 368, 8, 52, "Text",ExpressionUUID->"a321a3a5-c531-447c-99db-3891152ea4a0"],
Cell[21888, 660, 589, 18, 43, "Input",ExpressionUUID->"65517908-fe07-4249-8a72-4697b3bc60bc"],
Cell[22480, 680, 964, 30, 69, "Text",ExpressionUUID->"3ed4c555-7f44-40a0-b737-5e5b8a3d1b22"],
Cell[CellGroupData[{
Cell[23469, 714, 589, 17, 43, "Input",ExpressionUUID->"36537c03-8c9b-493b-802d-24b7785847fd"],
Cell[24061, 733, 2183, 46, 75, "Output",ExpressionUUID->"119a7d67-bfe9-4fbe-bec4-753f7008339e"]
}, Open  ]],
Cell[26259, 782, 228, 5, 52, "Text",ExpressionUUID->"1650435a-fc62-4ab9-a9b3-ed1e01b3bd12"],
Cell[CellGroupData[{
Cell[26512, 791, 708, 20, 43, "Input",ExpressionUUID->"cd28f5be-5187-4f9e-8707-dabe41dd3f4a"],
Cell[27223, 813, 2100, 44, 75, "Output",ExpressionUUID->"887ef62f-8b30-4f27-b738-1b362bf5d108"]
}, Open  ]],
Cell[29338, 860, 8632, 288, 519, "Text",ExpressionUUID->"754ee927-c0af-4a9d-9278-ba8a4db0f989"],
Cell[37973, 1150, 285, 6, 52, "Text",ExpressionUUID->"ef379402-8346-4a69-bbe1-f033a13a34e4"],
Cell[CellGroupData[{
Cell[38283, 1160, 1535, 36, 107, "Input",ExpressionUUID->"4194497e-0e2f-4a67-92be-bbd643dce955"],
Cell[39821, 1198, 2248, 54, 193, "Output",ExpressionUUID->"77fcb345-8fb5-4f7b-8de2-501f941e5cf2"],
Cell[42072, 1254, 1610, 37, 181, "Output",ExpressionUUID->"32d50125-082c-4f0c-ac84-642fbeb456e9"]
}, Open  ]],
Cell[43697, 1294, 220, 4, 52, "Text",ExpressionUUID->"cf6808e1-5248-4e9d-ae24-77630c0ace69"],
Cell[43920, 1300, 1063, 32, 82, "Input",ExpressionUUID->"ce8f1f53-27a4-475e-aaa0-3124e981b6d0"],
Cell[44986, 1334, 216, 4, 52, "Text",ExpressionUUID->"01d9769a-ddac-4afa-a6a6-357d9cc7cdd3"],
Cell[45205, 1340, 1063, 32, 82, "Input",ExpressionUUID->"c7fd865d-4a7d-4748-9093-958dda14b85e"],
Cell[46271, 1374, 837, 25, 119, "Text",ExpressionUUID->"67381f35-b207-4d4d-b9b3-20946cf1afe4"],
Cell[CellGroupData[{
Cell[47133, 1403, 1034, 24, 73, "Input",ExpressionUUID->"dcb29a07-a41f-43f9-a60c-ce1f69a6cebb"],
Cell[48170, 1429, 16325, 419, 251, "Output",ExpressionUUID->"1495bfd4-5dbe-4ee8-90a4-cdceda4a5768"],
Cell[64498, 1850, 2572, 61, 185, "Output",ExpressionUUID->"3a5b56c3-7297-4afd-8ba5-acfd692b578a"]
}, Open  ]],
Cell[67085, 1914, 364, 7, 52, "Text",ExpressionUUID->"d66e0729-b0a9-4cf1-b5ca-defdb7fcd6ac"],
Cell[67452, 1923, 363, 9, 73, "Input",ExpressionUUID->"0f7cdeaf-7a34-4d6a-9e41-17d1b897f848"],
Cell[67818, 1934, 241, 6, 52, "Text",ExpressionUUID->"5d2dbba9-c750-400b-a5c5-5b876b8b6759"],
Cell[68062, 1942, 1370, 32, 73, "Input",ExpressionUUID->"be1bde59-879b-40a5-9e61-835bded12d74"],
Cell[69435, 1976, 12580, 347, 1030, "Input",ExpressionUUID->"d83a240f-d61f-48df-904f-90bfe510c90c"],
Cell[82018, 2325, 299, 6, 52, "Text",ExpressionUUID->"a7a4ef5c-6e74-4307-9097-44641ae239c9"],
Cell[CellGroupData[{
Cell[82342, 2335, 1824, 38, 160, "Input",ExpressionUUID->"959f47f8-577c-48e5-9677-35cd0016ee12"],
Cell[84169, 2375, 2102, 46, 172, "Output",ExpressionUUID->"ea1a07af-4c8b-4a92-ab25-9a386f3b2dbc"],
Cell[86274, 2423, 1523, 35, 172, "Output",ExpressionUUID->"51152d07-129b-4b9c-8c4d-dec10bd9d2b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87834, 2463, 494, 10, 43, "Input",ExpressionUUID->"813e8a6f-792b-4df3-a373-5063a5a43bb4"],
Cell[88331, 2475, 9770, 252, 333, "Output",ExpressionUUID->"7abb5f5a-bb27-43bf-8657-4cb9c52cdf52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98138, 2732, 190, 4, 43, "Input",ExpressionUUID->"df63a4cb-9c76-4ec8-9e6f-25ba8dc3d72b"],
Cell[98331, 2738, 1052, 32, 86, "Output",ExpressionUUID->"a75847f4-b5fe-4314-a627-e29221959bf6"]
}, Open  ]]
}
]
*)

